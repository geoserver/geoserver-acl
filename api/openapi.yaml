openapi: 3.0.0
info:
  title: GeoServer Access Control List (ACL) API
  version: 1.0.0
  description: |
    This API provides comprehensive control over the GeoServer Access Control List (ACL) system.
    It allows for the management of fine-grained access rules and provides endpoints to query authorization decisions.

    The API is divided into three main areas:
    1.  **Data Rules:** For managing access to specific GeoServer resources (layers, services, etc.).
    2.  **Workspace Admin Rules:** For managing administrative privileges on a per-workspace basis.
    3.  **Authorization:** For querying the ACL system to determine access rights for a given request.

    Rules are evaluated in priority order (lower numbers = higher priority) to determine whether a request should be allowed, denied, or limited.
    The API also provides authorization endpoints that evaluate these rules for specific access requests.
servers:
- url: /api
  description: Base path for all API endpoints
tags:
  - name: DataRules
    description: |
      Manage data access rules that control permissions for GeoServer layers, workspaces, and OWS services.
      Rules can grant access (ALLOW), deny access (DENY), or impose restrictions (LIMIT) on resources.
  - name: WorkspaceAdminRules
    description: |
      Manage workspace administration rules that grant or restrict administrative privileges on GeoServer workspaces.
      These rules determine whether users can modify workspace configuration and content.
  - name: Authorization
    description: |
      Evaluate access rules for specific requests. These endpoints determine what permissions a user has
      for a given resource or operation by matching and applying the configured rules.
security:
  - basicAuth: []
paths:
  /rules:
    get:
      operationId: getRules
      summary: List all data rules
      description: |
        Retrieves all data access rules in priority order (lowest priority number first).
        Supports cursor-based pagination for large rule sets. Use the limit parameter to control page size
        and the nextCursor parameter to fetch subsequent pages.
      tags:
        - DataRules
      parameters:
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/nextCursor'
      responses:
        '200':
          $ref: '#/components/responses/PageOfRules'
    post:
      operationId: createRule
      summary: Create a new data rule
      description: |
        Creates a new data access rule. The rule will be inserted at the specified priority position.
        If a rule with the same identifier (same combination of user, role, service, request, workspace, layer, etc.)
        already exists, the operation will fail with a 409 Conflict.

        The priority determines evaluation order - lower numbers are evaluated first. Use the position parameter
        to control how the priority value is interpreted (fixed value, from start, or from end of the list).
      tags:
        - DataRules
      parameters:
        - $ref: '#/components/parameters/insertPosition'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Rule'
          application/x-jackson-smile:
            schema:
              $ref: '#/components/schemas/Rule'
      responses:
        '201':
          $ref: '#/components/responses/Rule'
        '400':
          description: |
            Invalid request. Common causes include:
            - Providing a rule with a non-null id (id is auto-generated)
            - Invalid field values or combinations
        '409':
          description: |
            A rule with the same identifier already exists. Rules are uniquely identified by the combination
            of: user, role, service, request, subfield, workspace, layer, and addressRange.
            If you need to modify an existing rule, use the PATCH endpoint instead.
          headers:
           X-Reason:
             schema:
               type: string
               description: Detailed error message explaining which properties caused the conflict
    delete:
      operationId: deleteAllRules
      summary: Delete all data rules
      description: |
        Removes all data access rules from the system. This operation is atomic - either all rules
        are deleted successfully, or none are deleted. Returns the count of rules that were removed.
        Use with caution as this operation cannot be undone.
      tags:
        - DataRules
      responses:
        '200':
          $ref: '#/components/responses/Count'

  /rules/query:
    post:
      operationId: queryRules
      summary: Query data rules with filters
      description: |
        Searches for data rules matching the provided filter criteria. Supports cursor-based pagination.
        The filter allows matching on user, roles, service, request, workspace, layer, and source IP address.
        Empty filters or wildcard values match any value for that property.
      tags:
        - DataRules
      parameters:
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/nextCursor'
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RuleFilter'
          application/x-jackson-smile:
            schema:
              $ref: '#/components/schemas/RuleFilter'
      responses:
        '200':
          $ref: '#/components/responses/PageOfRules'
  /rules/query/count:
    get:
      operationId: countAllRules
      summary: Count all data rules
      description: |
        Returns the total number of data access rules currently configured in the system.
      tags:
        - DataRules
      responses:
        '200':
          $ref: '#/components/responses/Count'
    post:
      operationId: countRules
      summary: Count rules matching filter criteria
      description: |
        Returns the number of data rules that match the provided filter criteria.
        Useful for determining result set size before paginating through query results.
      tags:
        - DataRules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RuleFilter'
          application/x-jackson-smile:
            schema:
              $ref: '#/components/schemas/RuleFilter'
      responses:
        '200':
          $ref: '#/components/responses/Count'
  /rules/query/one/priority/{priority}:
    get:
      operationId: findOneRuleByPriority
      summary: Find rule by priority value
      description: |
        Retrieves the data rule with the specified priority value. If multiple rules somehow have
        the same priority (which shouldn't normally occur), returns a 409 Conflict error.
      tags:
        - DataRules
      parameters:
      - name: priority
        in: path
        required: true
        description: The rule priority to search for
        schema:
          type: integer
          format: int64
      responses:
        '200':
          $ref: '#/components/responses/Rule'
        '404':
          description: Not found
        '409':
          description: Conflict, there's more than one rule with the requested priority

  /rules/id/{id}:
    parameters:
      - $ref: '#/components/parameters/id'
    get:
      operationId: getRuleById
      summary: Get rule by ID
      description: Retrieves a specific data rule by its unique identifier.
      tags:
        - DataRules
      responses:
        '200':
          $ref: '#/components/responses/Rule'
        '404':
          description: No rule exists with the specified ID
    patch:
      operationId: updateRuleById
      summary: Update an existing data rule
      description: |
        Updates an existing data rule. You can modify any property of the rule, including its priority.
        If you change the rule's identifier properties (user, role, service, etc.) to match another
        existing rule, the operation will fail with a 409 Conflict.
      tags:
        - DataRules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Rule'
          application/x-jackson-smile:
            schema:
              $ref: '#/components/schemas/Rule'
      responses:
        '200':
          $ref: '#/components/responses/Rule'
        '400':
          description: Invalid request body or field values
        '404':
          description: No rule exists with the specified ID
        '409':
          description: |
            The updated rule identifier properties would conflict with another existing rule.
            Rules must have unique combinations of user, role, service, request, workspace, layer, etc.
    delete:
      operationId: deleteRuleById
      summary: Delete a data rule
      description: Permanently removes the specified data rule from the system.
      tags:
        - DataRules
      responses:
        '200':
          description: Rule successfully deleted
        '404':
          description: No rule exists with the specified ID
  /rules/id/{id}/exists:
    parameters:
      - $ref: '#/components/parameters/id'
    get:
      operationId: ruleExistsById
      summary: Check if rule exists
      description: Checks whether a data rule with the specified ID exists in the system.
      tags:
        - DataRules
      responses:
        '200':
          description: Returns true if the rule exists, false otherwise
          content:
            application/json:
              schema:
                type: boolean
            application/x-jackson-smile:
              schema:
                type: boolean

  /rules/id/{id}/layer-details:
    parameters:
      - $ref: '#/components/parameters/id'
    get:
      operationId: getLayerDetailsByRuleId
      description: Returns the LayerDetails for the Rule with the given identifier
      tags:
        - DataRules
      responses:
        '200':
          $ref: '#/components/responses/LayerDetails'
        '204':
          description: The rule has a layer set but does not have LayerDetails set
        '400':
          description: Bad request if the rule does not have a layer name set
        '404':
          description: Not found if the rule does not exist
    put:
      operationId: setRuleLayerDetails
      tags:
        - DataRules
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LayerDetails'
          application/x-jackson-smile:
            schema:
              $ref: '#/components/schemas/LayerDetails'
      responses:
        '204':
          description: Updated
        '404':
          description: Not found
  /rules/id/{id}/limits:
    parameters:
      - $ref: '#/components/parameters/id'
    put:
      operationId: setRuleLimits
      tags:
        - DataRules
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RuleLimits'
          application/x-jackson-smile:
            schema:
              $ref: '#/components/schemas/RuleLimits'
      responses:
        '204':
          description: Updated
        '400':
          description: Bad request, the rule is not of LIMIT type
        '404':
          description: Not found
  /rules/id/{id}/styles:
    parameters:
      - $ref: '#/components/parameters/id'
    put:
      operationId: setRuleAllowedStyles
      tags:
        - DataRules
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: array
              nullable: true
              uniqueItems: true
              items:
                type: string
          application/x-jackson-smile:
            schema:
              type: array
              nullable: true
              uniqueItems: true
              items:
                type: string
      responses:
        '204':
          description: Updated
        '404':
          description: Not found

  /rules/id/{id}/swapwith/{id2}:
    parameters:
      - $ref: '#/components/parameters/id'
      - name: id2
        in: path
        required: true
        description: The rule identifier to swap priorities with
        schema:
          type: string
    post:
      operationId: swapRules
      tags:
        - DataRules
      responses:
        '204':
          description: Updated
        '404':
          description: Not found
  /rules/shift:
    post:
      operationId: shiftRulesByPriority
      parameters:
        - name: priorityStart
          in: query
          required: true
          description: The minimum priority to start shifting at (inclusive)
          schema:
            type: integer
            format: int64
        - name: offset
          in: query
          required: true
          description: The priority offset to apply to all rules from priorityStart onwards
          schema:
            type: integer
            format: int64
            minimum: 1
      tags:
        - DataRules
      responses:
        '200':
          description: The number of rules whose priority was shifted by the required offset
          content:
            application/json:
              schema:
                type: integer
            application/x-jackson-smile:
              schema:
                type: integer
        '404':
          description: Not found
  /adminrules:
    get:
      operationId: findAllAdminRules
      description: Returns an (optionally) paginated list of admin rules.
      tags:
        - WorkspaceAdminRules
      parameters:
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/nextCursor'
      responses:
        '200':
          $ref: '#/components/responses/PageOfAdminRules'
    post:
      operationId: createAdminRule
      tags:
        - WorkspaceAdminRules
      parameters:
        - $ref: '#/components/parameters/insertPosition'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AdminRule'
          application/x-jackson-smile:
            schema:
              $ref: '#/components/schemas/AdminRule'
      responses:
        '201':
          $ref: '#/components/responses/AdminRule'
    delete:
      operationId: deleteAllAdminRules
      description: Atomically deletes all admin rules and return the number of rules removed
      tags:
        - WorkspaceAdminRules
      responses:
        '200':
          $ref: '#/components/responses/Count'

  /adminrules/query:
    post:
      parameters:
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/nextCursor'
      operationId: findAdminRules
      tags:
        - WorkspaceAdminRules
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AdminRuleFilter'
          application/x-jackson-smile:
            schema:
              $ref: '#/components/schemas/AdminRuleFilter'
      responses:
        '200':
          $ref: '#/components/responses/PageOfAdminRules'
  /adminrules/query/count:
    get:
      operationId: countAllAdminRules
      description: Returns the total number of rules
      tags:
        - WorkspaceAdminRules
      responses:
        '200':
          $ref: '#/components/responses/Count'
    post:
      operationId: countAdminRules
      description: Returns the number of rules that matches the search criteria
      tags:
        - WorkspaceAdminRules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AdminRuleFilter'
          application/x-jackson-smile:
            schema:
              $ref: '#/components/schemas/AdminRuleFilter'
      responses:
        '200':
          $ref: '#/components/responses/Count'

  /adminrules/query/one/priority/{priority}:
    get:
      operationId: findOneAdminRuleByPriority
      description: Finds the AdminRule with the given priority
      tags:
        - WorkspaceAdminRules
      parameters:
      - name: priority
        in: path
        required: true
        description: The rule priority to search for
        schema:
          type: integer
          format: int64
      responses:
        '200':
          $ref: '#/components/responses/AdminRule'
        '404':
          description: Not found
        '409':
          description: Conflict, there's more than one rule with the requested priority
  /adminrules/query/first:
    post:
      operationId: findFirstAdminRule
      description: Finds the first rule that satisfies the query criteria
      tags:
        - WorkspaceAdminRules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AdminRuleFilter'
          application/x-jackson-smile:
            schema:
              $ref: '#/components/schemas/AdminRuleFilter'
      responses:
        '200':
          $ref: '#/components/responses/AdminRule'
        '404':
          description: Not found

  /adminrules/id/{id}:
    parameters:
      - $ref: '#/components/parameters/id'
    get:
      operationId: getAdminRuleById
      description: Returns the AdminRule with the given identifier
      tags:
        - WorkspaceAdminRules
      responses:
        '200':
          $ref: '#/components/responses/AdminRule'
        '404':
          description: Not found
    patch:
      operationId: updateAdminRule
      tags:
        - WorkspaceAdminRules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AdminRule'
          application/x-jackson-smile:
            schema:
              $ref: '#/components/schemas/AdminRule'
      responses:
        '200':
          $ref: '#/components/responses/AdminRule'
        '400':
          description: Bad request body
        '404':
          description: Not found
        '409':
          description: Conflict, tried to update the rule identifier properties to one that belongs to another rule
    delete:
      operationId: deleteAdminRuleById
      tags:
        - WorkspaceAdminRules
      responses:
        '200':
          description: OK
        '404':
          description: Not found
  /adminrules/id/{id}/exists:
    parameters:
      - $ref: '#/components/parameters/id'
    get:
      operationId: adminRuleExistsById
      description: Returns whether the AdminRule with the given identifier exists
      tags:
        - WorkspaceAdminRules
      responses:
        '200':
          description: boolean indicating whether the admin rule with the provided identifier exists
          content:
            application/json:
              schema:
                type: boolean
            application/x-jackson-smile:
              schema:
                type: boolean

  /adminrules/id/{id}/swapwith/{id2}:
    parameters:
      - $ref: '#/components/parameters/id'
      - name: id2
        in: path
        required: true
        description: The admin rule identifier to swap priorities with
        schema:
          type: string
    post:
      operationId: swapAdminRules
      tags:
        - WorkspaceAdminRules
      responses:
        '204':
          description: Updated
        '404':
          description: Not found
  /adminrules/shift:
    post:
      operationId: shiftAdminRulesByPriority
      parameters:
        - name: priorityStart
          in: query
          required: true
          description: The minimum priority to start shifting at (inclusive)
          schema:
            type: integer
            format: int64
        - name: offset
          in: query
          required: true
          description: The priority offset to apply to all rules from priorityStart onwards
          schema:
            type: integer
            format: int64
            minimum: 1
      tags:
        - WorkspaceAdminRules
      responses:
        '200':
          description: The number of admin rules whose priority was shifted by the required offset
          content:
            application/json:
              schema:
                type: integer
        '404':
          description: Not found

  /authorization/admin:
    post:
      operationId: getAdminAuthorization
      summary: Evaluate workspace administration access
      description: |
        Determines whether a user has administrative privileges on a specific workspace by evaluating
        the configured admin rules. Returns admin access information including whether the user has
        full administrative rights or only user-level access to the workspace.
      tags:
        - Authorization
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AdminAccessRequest'
          application/x-jackson-smile:
            schema:
              $ref: '#/components/schemas/AdminAccessRequest'
      responses:
        '200':
          $ref: '#/components/responses/AdminAccessInfo'
  /authorization/resources:
    post:
      operationId: getAccessInfo
      summary: Evaluate resource access permissions
      description: |
        Evaluates the data access rules for a specific request and returns the compiled access permissions.
        The response indicates whether access is granted, denied, or limited, along with any applicable
        restrictions such as spatial filters, CQL filters, allowed styles, and attribute-level permissions.
        Rules are evaluated in priority order until a matching rule determines the final access decision.
      tags:
        - Authorization
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AccessRequest'
          application/x-jackson-smile:
            schema:
              $ref: '#/components/schemas/AccessRequest'
      responses:
        '200':
          $ref: '#/components/responses/AccessInfo'
  /authorization/resources/matchingrules:
    post:
      operationId: getMatchingRules
      summary: Get rules that match an access request
      description: |
        Returns the list of data rules that match and would be applied when evaluating the given access request.
        This is useful for debugging and understanding which rules affect a particular request.
        Rules are returned in the order they would be evaluated (by priority).
      tags:
        - Authorization
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AccessRequest'
          application/x-jackson-smile:
            schema:
              $ref: '#/components/schemas/AccessRequest'
      responses:
        '200':
          $ref: '#/components/responses/PageOfRules'
  /authorization/accesssummary:
    post:
      operationId: getUserAccessSummary
      summary: Get user access summary across workspaces
      description: |
        Provides a comprehensive summary of what resources a user can access across all workspaces.
        For each workspace, returns the admin access level and lists of allowed and forbidden layers.
        This is useful for building user interfaces that need to display what resources are available
        to a particular user.
      tags:
        - Authorization
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AccessSummaryRequest'
          application/x-jackson-smile:
            schema:
              $ref: '#/components/schemas/AccessSummaryRequest'
      responses:
        '200':
          $ref: '#/components/responses/AccessSummary'

components:
  securitySchemes:
    basicAuth:
      type: http
      scheme: basic
  parameters:
    id:
      name: id
      in: path
      required: true
      description: |
        Unique identifier for the rule. This is a system-generated ID that uniquely identifies
        a specific rule instance.
      schema:
        type: string
      example: "a3f4b2c1-d5e6-7890-abcd-ef1234567890"
    nextCursor:
      name: nextCursor
      in: query
      description: |
        Cursor for pagination. When a response includes an X-ACL-NEXTCURSOR header, use that value
        here to fetch the next page of results. Continue until X-ACL-NEXTCURSOR is null or absent,
        indicating no more results are available. This implements efficient cursor-based pagination
        that works well with large datasets.
      required: false
      schema:
        type: string
    limit:
      name: limit
      in: query
      description: |
        Maximum number of items to return in a single page. If more items match the query than this limit,
        the response will include an X-ACL-NEXTCURSOR header with a cursor value to fetch the next page.
        Use in combination with nextCursor to paginate through large result sets.
      required: false
      schema:
        type: integer
      example: 50
    insertPosition:
      name: position
      in: query
      description: |
        Controls how the rule's priority value should be interpreted when inserting a new rule.
        See the InsertPosition schema for detailed explanation of FIXED, FROM_START, and FROM_END options.
        Defaults to FIXED if not specified.
      required: false
      schema:
        $ref: '#/components/schemas/InsertPosition'
  responses:
    Rule:
      description: |
        A data access rule. Returned after successfully creating, retrieving, or updating a rule.
        The response includes the complete rule definition with its system-generated ID.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Rule'
        application/x-jackson-smile:
          schema:
            $ref: '#/components/schemas/Rule'
    LayerDetails:
      description: |
        Layer-specific access control details. These settings provide fine-grained control over
        what data and styles can be accessed for a specific layer.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/LayerDetails'
        application/x-jackson-smile:
          schema:
            $ref: '#/components/schemas/LayerDetails'
    AdminRule:
      description: |
        A workspace administration rule. Returned after successfully creating, retrieving, or updating
        an admin rule. The response includes the complete rule definition with its system-generated ID.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/AdminRule'
        application/x-jackson-smile:
          schema:
            $ref: '#/components/schemas/AdminRule'
    Count:
      description: |
        The total number of rules that match the query criteria. This count represents the full result set,
        not just the current page if pagination is being used.
      content:
        application/json:
          schema:
            type: integer
            example: 42
    PageOfRules:
      description: |
        A paginated list of data access rules matching the query criteria. Rules are returned in priority order
        (lowest priority number first). If more rules exist beyond this page, check the X-ACL-NEXTCURSOR header
        to fetch the next page. An empty array indicates no rules match or you've reached the end of results.
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/Rule'
        application/x-jackson-smile:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/Rule'
      headers:
       X-ACL-NEXTCURSOR:
         schema:
           type: string
         description: |
           Cursor identifier for fetching the next page of results. Use this value as the nextCursor parameter
           in a subsequent request to get the next page. If null or absent, there are no more results available.
    PageOfAdminRules:
      description: |
        A paginated list of workspace admin rules matching the query criteria. Rules are returned in priority order
        (lowest priority number first). If more rules exist beyond this page, check the X-ACL-NEXTCURSOR header
        to fetch the next page. An empty array indicates no rules match or you've reached the end of results.
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/AdminRule'
        application/x-jackson-smile:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/AdminRule'
      headers:
       X-ACL-NEXTCURSOR:
         schema:
           type: string
         description: |
           Cursor identifier for fetching the next page of results. Use this value as the nextCursor parameter
           in a subsequent request to get the next page. If null or absent, there are no more results available.
    AccessInfo:
      description: |
        The result of evaluating access rules for a resource request. This response contains the final access decision
        (ALLOW, DENY, or LIMIT) along with any applicable restrictions such as spatial filters, CQL filters,
        allowed styles, and attribute-level permissions. Includes a list of rule IDs that were applied to reach this decision.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/AccessInfo'
        application/x-jackson-smile:
          schema:
            $ref: '#/components/schemas/AccessInfo'
    AdminAccessInfo:
      description: |
        The result of evaluating admin rules for workspace access. Indicates whether the user has administrative
        privileges on the requested workspace and includes the ID of the matching admin rule.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/AdminAccessInfo'
        application/x-jackson-smile:
          schema:
            $ref: '#/components/schemas/AdminAccessInfo'
    AccessSummary:
      description: The list of per-workspace access summary for a user
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/AccessSummary'
        application/x-jackson-smile:
          schema:
            $ref: '#/components/schemas/AccessSummary'
  schemas:
    CatalogMode:
      type: string
      nullable: true
      enum:
        - HIDE
        - CHALLENGE
        - MIXED
    SpatialFilterType:
      type: string
      nullable: true
      enum:
        - INTERSECT
        - CLIP

    Geom:
      anyOf:
      - $ref: '#/components/schemas/wkt'
      - $ref: '#/components/schemas/wkb'

    wkt:
      type: object
      properties:
        wkt:
          type: string
          example: "SRID=4326;MULTIPOLYGON (((-180 -90, -180 90, 180 90, 180 -90, -180 -90)))"
    wkb:
      type: object
      properties:
        wkb:
          type: string
          format: byte

    AddressRange:
      type: string
      nullable: true
      pattern: '^([0-9]{1,3}\.){3}[0-9]{1,3}(\/([0-9]|[1-2][0-9]|3[0-2]))?$'
      description: |
        IPv4 address range in CIDR notation. Can be a single IP address (e.g., "192.168.1.1")
        or a range using subnet mask notation (e.g., "192.168.1.0/24").
      example: "192.168.1.0/24"

    Rule:
      type: object
      description: |
        A data access rule that controls permissions for GeoServer resources. Rules are evaluated in priority
        order (lower numbers first) to determine whether a request should be allowed, denied, or limited.

        Each rule matches requests based on a combination of criteria: user, role, IP address, OWS service type,
        request type, workspace, and layer. Properties set to null act as wildcards that match any value.

        Rules are uniquely identified by the combination of: user, role, service, request, subfield, workspace,
        layer, and addressRange. This means you cannot have two rules with the exact same matching criteria.
      required:
        - priority
        - access
      properties:
        id:
          type: string
          nullable: true
          description: Unique identifier for the rule. Auto-generated by the system.
        priority:
          type: integer
          format: int64
          description: |
            Evaluation order for this rule. Lower numbers have higher priority and are evaluated first.
            The first matching rule determines the access decision.
          example: 100
        extId:
          type: string
          nullable: true
          description: External identifier for integration with other systems.
        name:
          type: string
          nullable: true
          description: Human-readable name for this rule.
          example: "Allow WMS access to roads layer"
        description:
          type: string
          nullable: true
          description: Detailed description explaining the purpose of this rule.
        access:
          $ref: '#/components/schemas/GrantType'
        limits:
          $ref: '#/components/schemas/RuleLimits'
        role:
          type: string
          nullable: true
          description: |
            Role name to match. Null matches any role. The request matches if the user has this role.
          example: "ROLE_VIEWER"
        user:
          type: string
          nullable: true
          description: |
            Username to match. Null matches any user. Use "*" to explicitly match anonymous users.
          example: "john.doe"
        addressRange:
          $ref: '#/components/schemas/AddressRange'
        service:
          type: string
          nullable: true
          description: |
            OWS service type to match (e.g., WMS, WFS, WCS, WPS). Null matches any service.
          example: "WMS"
        request:
          type: string
          nullable: true
          description: |
            OWS request operation to match (e.g., GetMap, GetFeature, GetCoverage). Null matches any request.
          example: "GetMap"
        subfield:
          type: string
          nullable: true
          description: |
            Additional request-specific qualifier. Used for fine-grained control within a request type.
        workspace:
          type: string
          nullable: true
          description: |
            Workspace name to match. Null matches any workspace.
          example: "topp"
        layer:
          type: string
          nullable: true
          description: |
            Layer name to match. Null matches any layer within the matched workspace.
          example: "roads"
      example:
        priority: 100
        access: "ALLOW"
        role: "ROLE_VIEWER"
        service: "WMS"
        request: "GetMap"
        workspace: "topp"
        layer: "roads"
        name: "Allow WMS GetMap for roads layer"

    RuleLimits:
      type: object
      description: |
        Spatial and catalog restrictions applied when a rule's access type is LIMIT.
        Allows you to grant access to a resource while constraining what data can be accessed or how it appears.
      nullable: true
      properties:
        allowedArea:
          $ref: '#/components/schemas/Geom'
        spatialFilterType:
          $ref: '#/components/schemas/SpatialFilterType'
        catalogMode:
          $ref: '#/components/schemas/CatalogMode'

    LayerDetails:
      type: object
      description: |
        Detailed access control settings for a specific layer. These settings can only be configured
        for rules that specify a non-wildcarded workspace and layer name. LayerDetails allows you to
        define attribute-level permissions, CQL filters, spatial filters, allowed styles, and catalog mode.
      nullable: true
      properties:
        type:
          type: string
          nullable: true
          enum:
            - VECTOR
            - RASTER
            - LAYERGROUP
        defaultStyle:
          type: string
          nullable: true
        cqlFilterRead:
          type: string
          nullable: true
        cqlFilterWrite:
          type: string
          nullable: true
        allowedArea:
          $ref: '#/components/schemas/Geom'
        spatialFilterType:
          $ref: '#/components/schemas/SpatialFilterType'
        catalogMode:
          $ref: '#/components/schemas/CatalogMode'
        allowedStyles:
          type: array
          nullable: true
          uniqueItems: true
          items:
            type: string
        layerAttributes:
          type: array
          nullable: true
          uniqueItems: true
          items:
            $ref: '#/components/schemas/LayerAttribute'

    LayerAttribute:
      type: object
      description: Access restrictions to a FeatureType attribute
      required:
        - name
      properties:
        name:
          type: string
        dataType:
          type: string
          nullable: true
        access:
          type: string
          nullable: true
          enum:
            - NONE
            - READONLY
            - READWRITE
    InsertPosition:
      type: string
      description: |
        Controls how the rule's priority value is interpreted when creating a new rule:
        - FIXED: Use the exact priority value specified
        - FROM_START: Interpret priority as position from the beginning (0 = first)
        - FROM_END: Interpret priority as position from the end (0 = last)
      enum:
        - FIXED
        - FROM_START
        - FROM_END

    GrantType:
      type: string
      description: |
        The access decision for this rule:
        - ALLOW: Grant full access to the matched resource
        - DENY: Completely deny access to the matched resource
        - LIMIT: Grant access but apply restrictions defined in RuleLimits or LayerDetails
      nullable: true
      enum:
        - ALLOW
        - DENY
        - LIMIT

    AdminGrantType:
      type: string
      description: |
        The level of workspace administration access:
        - ADMIN: Full administrative access to the workspace (can modify configuration and content)
        - USER: Read-only user access to the workspace (can view but not modify)
      nullable: true
      enum:
        - ADMIN
        - USER

    AdminRule:
      type: object
      description: |
        A workspace administration rule that determines whether users have administrative privileges
        on specific workspaces. Admin rules are simpler than data rules - they only match on user,
        role, workspace, and IP address, and grant either ADMIN or USER level access.

        Rules are evaluated in priority order (lower numbers first) until a match is found.
        Like data rules, admin rules are uniquely identified by the combination of their matching criteria.
      required:
        - priority
        - access
      properties:
        id:
          type: string
          nullable: true
          description: Unique identifier for the rule. Auto-generated by the system.
        priority:
          type: integer
          format: int64
          description: |
            Evaluation order for this rule. Lower numbers have higher priority and are evaluated first.
          example: 50
        access:
          $ref: '#/components/schemas/AdminGrantType'
        extId:
          type: string
          nullable: true
          description: External identifier for integration with other systems.
        name:
          type: string
          nullable: true
          description: Human-readable name for this admin rule.
          example: "Grant admin access to cartography workspace"
        description:
          type: string
          nullable: true
          description: Detailed description explaining the purpose of this admin rule.
        role:
          type: string
          nullable: true
        user:
          type: string
          nullable: true
        workspace:
          type: string
          nullable: true
        addressRange:
          $ref: '#/components/schemas/AddressRange'

    TextFilter:
      type: object
      description: |
        Filter for matching text properties. Supports exact matching and wildcard behavior.
        The matching logic is:
        - If value is null or absent: matches rules where the property is set to any value or is null (wildcard)
        - If value is "*": matches only rules where the property is null (explicitly wildcard)
        - Otherwise: matches rules where the property equals the specified value
      nullable: true
      properties:
        includeDefault:
          type: boolean
          nullable: true
          description: |
            When true, includes rules with null/wildcard values for this property in the results.
            When false, only matches rules with an explicit value.
        value:
          type: string
          nullable: true
          description: |
            The value to match. Use "*" to explicitly match wildcard rules, null/absent to match any value.
          example: "WMS"

    SetFilter:
      type: object
      description: |
        Filter for matching against a set of possible values. Used for properties like roles where
        a rule might match any of several values.
      nullable: true
      properties:
        includeDefault:
          type: boolean
          nullable: true
          description: |
            When true, includes rules with null/wildcard values for this property.
            When false, only matches rules with explicit values from the provided set.
        values:
          type: array
          nullable: true
          uniqueItems: true
          description: |
            Set of values to match. A rule matches if its property value is in this set.
          items:
            type: string
          example: ["ROLE_ADMIN", "ROLE_EDITOR"]

    AddressRangeFilter:
      type: object
      description: |
        Filter for matching IP address ranges. Matches rules whose address range includes or overlaps
        with the specified address range.
      nullable: true
      properties:
        includeDefault:
          type: boolean
          nullable: true
          description: |
            When true, includes rules with null/wildcard address ranges in the results.
        value:
          $ref: '#/components/schemas/AddressRange'

    RuleFilter:
      type: object
      description: |
        Query filter for searching data access rules. All specified filter criteria must match for a rule
        to be included in results (AND logic). Omitted filters act as wildcards that match any value.
        Use this to find rules matching specific combinations of user, role, service, workspace, layer, etc.
      nullable: true
      properties:
        user:
          $ref: '#/components/schemas/TextFilter'
        roles:
          $ref: '#/components/schemas/SetFilter'
        service:
          $ref: '#/components/schemas/TextFilter'
        request:
          $ref: '#/components/schemas/TextFilter'
        subfield:
          $ref: '#/components/schemas/TextFilter'
        workspace:
          $ref: '#/components/schemas/TextFilter'
        layer:
          $ref: '#/components/schemas/TextFilter'
        sourceAddress:
          $ref: '#/components/schemas/AddressRangeFilter'
      example:
        workspace:
          value: "topp"
        service:
          value: "WMS"

    AdminRuleFilter:
      type: object
      description: |
        Query filter for searching workspace admin rules. All specified filter criteria must match for a rule
        to be included in results (AND logic). Omitted filters act as wildcards that match any value.
      nullable: true
      properties:
        grantType:
          $ref: '#/components/schemas/AdminGrantType'
        user:
          $ref: '#/components/schemas/TextFilter'
        roles:
          $ref: '#/components/schemas/SetFilter'
        workspace:
          $ref: '#/components/schemas/TextFilter'
        sourceAddress:
          $ref: '#/components/schemas/AddressRangeFilter'
      example:
        workspace:
          value: "cartography"
        grantType: "ADMIN"

    AccessRequest:
      type: object
      description: |
        Represents a request to access a GeoServer resource. This is used to evaluate what permissions
        a specific user has for a given operation on a workspace/layer combination. The system matches
        this request against configured rules to determine the access decision and any applicable restrictions.

        Properties default to wildcards ('*') which match any value when evaluating rules.
      properties:
        user:
          description: |
            The authenticated username making the request. This is matched against rule user filters.
          type: string
          example: "john.doe"
        roles:
          description: |
            The roles the user belongs to. A rule matches if the user has any of the rule's specified roles.
          type: array
          nullable: true
          uniqueItems: true
          items:
            type: string
          example: ["ROLE_VIEWER", "ROLE_EDITOR"]
        sourceAddress:
          type: string
          description: |
            The IP address the request originates from. Matched against rule address range filters.
          default: '*'
          example: "192.168.1.100"
        service:
          type: string
          description: |
            The OWS service type (WMS, WFS, WCS, WPS, etc.). Wildcard '*' matches any service.
          default: '*'
          example: "WMS"
        request:
          type: string
          description: |
            The OWS operation being requested (GetMap, GetFeature, GetCoverage, etc.). Wildcard '*' matches any operation.
          default: '*'
          example: "GetMap"
        subfield:
          type: string
          description: |
            Additional operation-specific qualifier for fine-grained control. Wildcard '*' matches any subfield.
          default: '*'
        workspace:
          type: string
          description: |
            The workspace being accessed. Wildcard '*' matches any workspace.
          default: '*'
          example: "topp"
        layer:
          type: string
          description: |
            The layer being accessed within the workspace. Wildcard '*' matches any layer.
          default: '*'
          example: "roads"

    AdminAccessRequest:
      type: object
      description: |
        Represents a request to determine administrative access to a workspace. This is used to evaluate
        whether a user has admin privileges on a specific workspace, which allows them to modify workspace
        configuration and content.
      properties:
        user:
          description: |
            The authenticated username making the admin access request.
          type: string
          example: "admin.user"
        roles:
          description: |
            The roles the user belongs to. Admin rules are matched against these roles.
          type: array
          nullable: true
          uniqueItems: true
          items:
            type: string
          example: ["ROLE_ADMIN"]
        sourceAddress:
          type: string
          description: |
            The IP address the request originates from.
          default: '*'
          example: "192.168.1.50"
        workspace:
          type: string
          description: |
            The workspace for which admin access is being evaluated. Wildcard '*' evaluates across all workspaces.
          default: '*'
          example: "cartography"

    AccessInfo:
      type: object
      description: |
        The result of evaluating access rules for a resource request. Contains the final access decision
        (ALLOW, DENY, or LIMIT) and any restrictions that apply. When access is LIMIT, additional properties
        define what data can be accessed and how it should be filtered or restricted.
      required:
      - grant
      properties:
        grant:
          $ref: '#/components/schemas/GrantType'
        area:
          $ref: '#/components/schemas/Geom'
          description: |
            Spatial extent allowed for INTERSECT-type spatial filtering. Only features intersecting this area are accessible.
        clipArea:
          $ref: '#/components/schemas/Geom'
          description: |
            Spatial extent for CLIP-type spatial filtering. Features are clipped to this area before being returned.
        catalogMode:
          $ref: '#/components/schemas/CatalogMode'
        defaultStyle:
          type: string
          description: |
            The default style to use when rendering this layer.
          example: "default_style"
        allowedStyles:
          type: array
          uniqueItems: true
          description: |
            List of style names the user is permitted to request. If present, only these styles can be used.
          items:
            type: string
          example: ["basic", "detailed"]
        cqlFilterRead:
          type: string
          description: |
            CQL filter expression applied when reading features. Only features matching this filter are visible.
          example: "status = 'public'"
        cqlFilterWrite:
          type: string
          description: |
            CQL filter expression applied when writing/modifying features. Only features matching this filter can be modified.
          example: "owner = 'current_user'"
        attributes:
          type: array
          nullable: true
          uniqueItems: true
          description: |
            Attribute-level access control. Specifies which feature attributes are accessible and their access level.
          items:
            $ref: '#/components/schemas/LayerAttribute'
        matchingRules:
          type: array
          description: |
            IDs of the rules that were evaluated and applied to produce this access decision. Useful for debugging and auditing.
          items:
            type: string

    AdminAccessInfo:
      type: object
      description: |
        The result of evaluating admin rules for workspace access. Indicates whether the user has
        administrative privileges on the workspace.
      required:
      - admin
      properties:
        admin:
          type: boolean
          description: |
            True if the user has administrative access to the workspace, false otherwise.
          example: true
        workspace:
          type: string
          description: |
            The workspace this admin access decision applies to.
          example: "cartography"
        matchingAdminRule:
          type: string
          description: |
            ID of the admin rule that determined this access decision. Useful for debugging and auditing.

    AccessSummaryRequest:
      type: object
      description: |
        Request for a comprehensive summary of what resources a user can access. Used to build user interfaces
        that display available workspaces and layers based on the user's permissions.
      required:
      - user
      - roles
      properties:
        user:
          description: |
            The username to generate the access summary for.
          type: string
          example: "viewer.user"
        roles:
          description: |
            The roles the user belongs to. Used to evaluate which rules apply to this user.
          type: array
          nullable: false
          uniqueItems: true
          items:
            type: string
          example: ["ROLE_VIEWER"]

    AccessSummary:
      type: object
      description: |
        Summary of what resources a user can access across all workspaces. For each workspace, lists
        the admin access level and which layers are allowed or forbidden.
      properties:
        workspaces:
          type: array
          description: |
            Per-workspace access summary for the user.
          items:
            $ref: '#/components/schemas/WorkspaceAccessSummary'

    WorkspaceAccessSummary:
      type: object
      description: |
        Summary of a user's access to resources within a specific workspace.
      properties:
        workspace:
          type: string
          description: |
            The workspace name this summary applies to.
          example: "topp"
        adminAccess:
          $ref: '#/components/schemas/AdminGrantType'
          description: |
            The level of administrative access the user has on this workspace (ADMIN or USER).
        allowed:
          description: |
            Layer names in this workspace that the user can access, possibly under specific conditions
            (e.g., particular OWS service/request combinations). These result from ALLOW rules.
          type: array
          nullable: true
          uniqueItems: true
          items:
            type: string
          example: ["roads", "buildings"]
        forbidden:
          description: |
            Layer names in this workspace that the user definitely cannot access under any circumstances.
            These result from DENY rules. This complements the allowed list - there may be ALLOW rules
            for all layers in a workspace except specific layers listed here as forbidden.
          type: array
          nullable: true
          uniqueItems: true
          items:
            type: string
          example: ["sensitive_data"]
